---
layout: page
title: Last 25 test results
---

{% comment %} ---- BEGIN TRAVIS ---- {% endcomment %}

{% assign travis_pages_list = site.pages | where: 'layout','travis-job' %}

{% assign travis_job_num_string_list = '' %}
{% for page in travis_pages_list %}
  {% comment %} Make job number 8 symbols long, prepended with zeros {% endcomment %}
  {% assign travis_job_sortkey = page.travis.job-number | prepend: '00000000' | slice: -8, 8 %}

  {% comment %} Append actual job number after sortkey, with a ^ as separator {% endcomment %}
  {% assign job_num_string = travis_job_sortkey | append: '^' | append: page.travis.job-number %}

  {% comment %} Add to string list {% endcomment %}
  {% if travis_job_num_string_list == '' %}
    {% assign travis_job_num_string_list = job_num_string %}
  {% else %}
    {% assign travis_job_num_string_list = travis_job_num_string_list | append: ',' | append: job_num_string %}
  {% endif %}
{% endfor %}

{% comment %} Convert to a list, and sort in descending order {% endcomment %}
{% assign travis_job_num_string_list = travis_job_num_string_list | split: ',' | sort | reverse %}

{% comment %} ---- END TRAVIS ---- {% endcomment %}



{% comment %} ---- BEGIN APPVEYOR ---- {% endcomment %}

{% assign appveyor_pages_list = site.pages | where: 'layout','appveyor-build' %}

{% assign appveyor_build_num_string_list = '' %}
{% for page in appveyor_pages_list %}
  {% comment %} Make build number 8 symbols long, prepended with zeros {% endcomment %}
  {% assign appveyor_build_sortkey = page.appveyor.build-number | prepend: '00000000' | slice: -8, 8 %}

  {% comment %} Append actual build number after sortkey, with a ^ as separator {% endcomment %}
  {% assign build_num_string = appveyor_build_sortkey | append: '^' | append: page.appveyor.build-number %}

  {% comment %} Add to string list {% endcomment %}
  {% if appveyor_build_num_string_list == '' %}
    {% assign appveyor_build_num_string_list = build_num_string %}
  {% else %}
    {% assign appveyor_build_num_string_list = appveyor_build_num_string_list | append: ',' | append: build_num_string %}
  {% endif %}
{% endfor %}

{% comment %} Convert to a list, and sort in descending order {% endcomment %}
{% assign appveyor_build_num_string_list = appveyor_build_num_string_list | split: ',' | sort | reverse %}

{% comment %} ---- END APPVEYOR ---- {% endcomment %}

<div style="width: 42rem; overflow: hidden;">
<div style="float: left; width: 20rem;">
<h2>Travis jobs</h2>
<table class="test-overview">
  <thead>
    <tr>
      <th>Job</th>
      <th>Branch</th>
      <th>Commit</th>
      <th>#</th>
    </tr>
  </thead>
  <tbody>
  {% for job_num_string in travis_job_num_string_list limit:25 %}
    {% assign job_num_string_parts = job_num_string | split: '^' %}
    {% assign travis_job_number = job_num_string_parts[1] %}
    {% for page in travis_pages_list %}
      {% capture page_job_num_str %}{{ page.travis.job-number }}{% endcapture %}
      {% if page_job_num_str == travis_job_number %}
        {% if page.travis.test-result == 0 %}
          {% assign passed = true %}
        {% else %}
          {% assign passed = false %}
        {% endif %}
        {% capture travis_job_data_name %}{{ page.travis.job-number | replace: '.', '_' }}{% endcapture %}
        {% assign result_map = site.data.travis-builds[travis_job_data_name] %}
        {% capture commit_hash %}{{ page.travis.commit }}{% endcapture %}
        <tr class="{% if passed %}passed{% else %}failed{% endif %}">
          <td><a href="{{ site.baseurl }}{{ page.url }}">#{{ page.travis.job-number }}</a></td>
          <td><a href="https://github.com/egraff/uit-thesis/tree/{{ page.travis.branch }}">{{ page.travis.branch }}</a></td>
          <td><a href="https://github.com/egraff/uit-thesis/commit/{{ commit_hash }}">{{ commit_hash | truncate: 9 }}</a></td>
          <td>
            {% unless result_map %}
              N/A
            {% else %}
              {{ result_map.num_tests | minus: result_map.failed_tests.size }}/{{ result_map.num_tests }}
            {% endunless %}
          </td>
        </tr>
      {% endif %}
    {% endfor %}
  {% endfor %}
  </tbody>
</table>
</div>
<div style="float: left; width: 20rem; margin-left: 1rem">
<h2>AppVeyor jobs</h2>
<table class="test-overview">
  <thead>
    <tr>
      <th>Build</th>
      <th>Branch</th>
      <th>Commit</th>
      <th>#</th>
    </tr>
  </thead>
  <tbody>
  {% for build_num_string in appveyor_build_num_string_list limit:25 %}
    {% assign build_num_string_parts = build_num_string | split: '^' %}
    {% assign appveyor_build_number = build_num_string_parts[1] %}
    {% for page in appveyor_pages_list %}
      {% capture page_build_num_str %}{{ page.appveyor.build-number }}{% endcapture %}
      {% if page_build_num_str == appveyor_build_number %}
        {% if page.appveyor.test-result == 0 %}
          {% assign passed = true %}
        {% else %}
          {% assign passed = false %}
        {% endif %}
        {% capture appveyor_build_data_name %}{{ page.appveyor.build-number }}{% endcapture %}
        {% assign result_map = site.data.appveyor-builds[appveyor_build_data_name] %}
        {% capture commit_hash %}{{ page.appveyor.commit }}{% endcapture %}
        <tr class="{% if passed %}passed{% else %}failed{% endif %}">
          <td><a href="{{ site.baseurl }}{{ page.url }}">#{{ page.appveyor.build-number }}</a></td>
          <td><a href="https://github.com/egraff/uit-thesis/tree/{{ page.appveyor.branch }}">{{ page.appveyor.branch }}</a></td>
          <td><a href="https://github.com/egraff/uit-thesis/commit/{{ commit_hash }}">{{ commit_hash | truncate: 9 }}</a></td>
          <td>
            {% unless result_map %}
              N/A
            {% else %}
              {{ result_map.num_tests | minus: result_map.failed_tests.size }}/{{ result_map.num_tests }}
            {% endunless %}
          </td>
        </tr>
      {% endif %}
    {% endfor %}
  {% endfor %}
  </tbody>
</table>
</div>
</div>
